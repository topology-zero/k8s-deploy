import{s as C,J as z,L as B,r as D,c as i,M as r,g as a,f as t,j as d,T as g,P as I,l as F,m as T,E as R,n as $,Q as S,_ as A,o as N,R as j,d as L,e as q,S as M,I as x,p as O,q as G}from"./index-cc90a63c.js";import{E as J,a as P}from"./el-table-column-25359a9a.js";import{E as Q,a as H}from"./el-radio-ca630d0f.js";import{E as K}from"./index-12cbd309.js";import{E as W}from"./index-2c9c9e7e.js";function X(n){return C({url:"/auth",params:n})}function Y(n){return C({url:"/auth",method:"post",data:n})}function Z(n,v){return C({url:"/auth/"+n,method:"put",data:v})}function ee(n){return C({url:"/auth/"+n,method:"delete"})}const ae={__name:"add-edit-dialog",props:{visible:{type:Boolean},visibleModifiers:{},formData:{type:Object},formDataModifiers:{}},emits:z(["done"],["update:visible","update:formData"]),setup(n,{emit:v}){const h=v,p=B(n,"visible"),e=B(n,"formData"),y=D(),k=async()=>{await y.value.validate(),e.value.isMenu==1&&(e.value.action="",e.value.api=""),e.value.id==0?await Y(e.value):await Z(e.value.id,e.value),I.success("成功"),p.value=!1,h("done")};return(w,o)=>{const V=F,_=T,u=Q,m=H,b=R,c=$,f=S;return i(),r(f,{modelValue:p.value,"onUpdate:modelValue":o[7]||(o[7]=s=>p.value=s),"close-on-click-modal":!1,title:e.value.id==0?"添加权限":"编辑权限"},{footer:a(()=>[t(c,{onClick:o[5]||(o[5]=s=>p.value=!1)},{default:a(()=>[d("取消")]),_:1}),t(c,{type:"primary",onClick:o[6]||(o[6]=s=>k())},{default:a(()=>[d("确定")]),_:1})]),default:a(()=>[t(b,{ref_key:"elFormRef",ref:y,model:e.value,"label-width":"100px"},{default:a(()=>[t(_,{label:"节点名",rules:{required:!0,trigger:"blur",message:"请输入节点名"},prop:"name"},{default:a(()=>[t(V,{modelValue:e.value.name,"onUpdate:modelValue":o[0]||(o[0]=s=>e.value.name=s)},null,8,["modelValue"])]),_:1}),t(_,{label:"权限标识",rules:{required:!0,trigger:"blur",message:"请输入权限标识"},prop:"key"},{default:a(()=>[t(V,{modelValue:e.value.key,"onUpdate:modelValue":o[1]||(o[1]=s=>e.value.key=s)},null,8,["modelValue"])]),_:1}),t(_,{label:"是否菜单栏",rules:{required:!0,trigger:"blur",type:"enum",enum:[0,1],message:"请选择是否菜单栏"},prop:"isMenu"},{default:a(()=>[t(m,{modelValue:e.value.isMenu,"onUpdate:modelValue":o[2]||(o[2]=s=>e.value.isMenu=s),modelModifiers:{number:!0},size:"default"},{default:a(()=>[t(u,{border:"",label:0},{default:a(()=>[d("否")]),_:1}),t(u,{border:"",label:1},{default:a(()=>[d("是")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.value.isMenu==0?(i(),r(_,{key:0,label:"请求方法",rules:{required:!0,trigger:"blur",message:"请输入请求方法"},prop:"action"},{default:a(()=>[t(m,{modelValue:e.value.action,"onUpdate:modelValue":o[3]||(o[3]=s=>e.value.action=s),size:"default"},{default:a(()=>[t(u,{border:"",label:"get"}),t(u,{border:"",label:"post"}),t(u,{border:"",label:"put"}),t(u,{border:"",label:"delete"})]),_:1},8,["modelValue"])]),_:1})):g("",!0),e.value.isMenu==0?(i(),r(_,{key:1,label:"请求接口",rules:{required:!0,trigger:"blur",message:"请输入请求接口"},prop:"api"},{default:a(()=>[t(V,{modelValue:e.value.api,"onUpdate:modelValue":o[4]||(o[4]=s=>e.value.api=s)},null,8,["modelValue"])]),_:1})):g("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}};const te=n=>(O("data-v-52328309"),n=n(),G(),n),le={class:"app-container auths"},oe=te(()=>q("p",{class:"page-title"},"权限管理",-1)),ne={class:"filter-container"},ue={__name:"index",setup(n){const v=()=>({id:0,pid:0,name:"",key:"",isMenu:0,action:"",api:""}),h=D(!0),p=D(!1),e=D({}),y=D([]),k=async()=>{const{data:u}=await X();y.value=u,h.value=!1};N(async()=>{await k()});const w=()=>{p.value=!0,e.value=v(),e.value.isMenu=1},o=u=>{p.value=!0,e.value=v(),e.value.pid=u.id},V=u=>{p.value=!0,Object.assign(e.value,u)},_=async u=>{await K.confirm("删除权限将不可恢复","警告");const{message:m}=await ee(u.id);I.success(m),k()};return(u,m)=>{const b=$,c=P,f=W,s=J,E=j("permission");return i(),L("div",le,[oe,q("div",ne,[M((i(),r(b,{type:"primary",plain:"",class:"filter-item",size:"default",onClick:m[0]||(m[0]=l=>w())},{default:a(()=>[d(" 添加顶级权限 ")]),_:1})),[[E,"admin:auth:add"]])]),t(s,{data:y.value,"node-key":"id","default-expand-all":"","tree-props":{label:"name"},"row-key":"id",border:""},{default:a(()=>[t(c,{align:"left",prop:"name",label:"节点名","min-width":"200"}),t(c,{align:"left",prop:"key",label:"权限标识",width:"180"}),t(c,{align:"center",label:"是否菜单栏",width:"150"},{default:a(({row:l})=>[l.isMenu==0?(i(),r(f,{key:0,type:"warning"},{default:a(()=>[d("否")]),_:1})):(i(),r(f,{key:1,type:"success"},{default:a(()=>[d("是")]),_:1}))]),_:1}),t(c,{align:"center",label:"请求方法",width:"150"},{default:a(({row:l})=>[l.action=="get"?(i(),r(f,{key:0},{default:a(()=>[d(x(l.action),1)]),_:2},1024)):g("",!0),l.action=="post"?(i(),r(f,{key:1,type:"success"},{default:a(()=>[d(x(l.action),1)]),_:2},1024)):g("",!0),l.action=="put"?(i(),r(f,{key:2,type:"info"},{default:a(()=>[d(x(l.action),1)]),_:2},1024)):g("",!0),l.action=="delete"?(i(),r(f,{key:3,type:"danger"},{default:a(()=>[d(x(l.action),1)]),_:2},1024)):g("",!0)]),_:1}),t(c,{align:"left",prop:"api","min-width":"100",label:"请求接口"}),t(c,{align:"center",label:"操作",width:"260"},{default:a(({row:l})=>[M((i(),r(b,{type:"success",size:"small",onClick:U=>o(l)},{default:a(()=>[d(" 新增子权限 ")]),_:2},1032,["onClick"])),[[E,"admin:auth:add"]]),M((i(),r(b,{type:"primary",size:"small",onClick:U=>V(l)},{default:a(()=>[d(" 编辑 ")]),_:2},1032,["onClick"])),[[E,"admin:auth:edit"]]),M((i(),r(b,{type:"danger",size:"small",onClick:U=>_(l)},{default:a(()=>[d(" 删除 ")]),_:2},1032,["onClick"])),[[E,"admin:auth:del"]])]),_:1})]),_:1},8,["data"]),t(ae,{visible:p.value,"onUpdate:visible":m[1]||(m[1]=l=>p.value=l),formData:e.value,"onUpdate:formData":m[2]||(m[2]=l=>e.value=l),onDone:k},null,8,["visible","formData"])])}}},pe=A(ue,[["__scopeId","data-v-52328309"]]);export{pe as default};
