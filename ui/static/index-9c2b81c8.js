import{s as w,J as K,K as j,L as $,r as B,c as f,M as y,g as t,f as e,j as _,P as R,l as T,m as L,E as q,n as I,Q,R as H,d as W,e as F,S as k,G as s}from"./index-45490d46.js";import{E as X}from"./el-pagination-e9fd92a9.js";import{E as Z,a as ee}from"./el-table-column-63ea15fa.js";import"./el-select-4076887c.js";import"./el-checkbox-43c79793.js";import{E as te,a as ae}from"./el-col-439bec59.js";import{u as le}from"./page-56987b87.js";import{Y as oe}from"./index-d025be05.js";import{v as ne}from"./directive-5b5f6efd.js";import{E as se}from"./index-a0985bb2.js";import"./index-cf7261e3.js";function ie(o){return w({url:"/template",params:o})}function re(o){return w({url:"/template",method:"post",data:o})}function ue(o,v){return w({url:"/template/"+o,method:"put",data:v})}function de(o){return w({url:"/template/"+o,method:"delete"})}const me={__name:"add-edit-dialog",props:{visible:{type:Boolean},visibleModifiers:{},formData:{type:Object},formDataModifiers:{}},emits:K(["done"],["update:visible","update:formData"]),setup(o,{emit:v}){const z=j(),p=v,r=$(o,"visible"),a=$(o,"formData"),c=B(),C=async()=>{await c.value.validate(),a.value.id==0?await re(a.value):await ue(a.value.id,a.value),r.value=!1,p("done"),z.getTemplate(),R.success("成功")};return(d,l)=>{const g=T,b=L,x=q,E=I,S=Q;return f(),y(S,{title:a.value.id==0?"添加模板":"编辑模板","close-on-click-modal":!1,modelValue:r.value,"onUpdate:modelValue":l[5]||(l[5]=n=>r.value=n),width:"50%"},{footer:t(()=>[e(E,{onClick:l[3]||(l[3]=n=>r.value=!1)},{default:t(()=>[_("取 消")]),_:1}),e(E,{type:"primary",onClick:l[4]||(l[4]=n=>C())},{default:t(()=>[_("确 定")]),_:1})]),default:t(()=>[e(x,{ref_key:"elFormRef",ref:c,model:a.value,"label-width":"160px"},{default:t(()=>[e(b,{label:"模板名",rules:{required:!0,trigger:"blur",message:"请输入模板名"},prop:"name"},{default:t(()=>[e(g,{modelValue:a.value.name,"onUpdate:modelValue":l[0]||(l[0]=n=>a.value.name=n)},null,8,["modelValue"])]),_:1}),e(b,{label:"模板名描述",prop:"desc"},{default:t(()=>[e(g,{modelValue:a.value.desc,"onUpdate:modelValue":l[1]||(l[1]=n=>a.value.desc=n)},null,8,["modelValue"])]),_:1}),e(b,{label:"模板编辑",rules:{required:!0,trigger:"blur",message:"请输入模板编辑"},prop:"content"},{default:t(()=>[e(oe,{modelValue:a.value.content,"onUpdate:modelValue":l[2]||(l[2]=n=>a.value.content=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}},pe={class:"app-container"},ce=F("p",{class:"page-title"},"模板列表",-1),fe={class:"filter-container"},_e={class:"page-container"},xe={__name:"index",setup(o){const v=j(),z=()=>({id:0,name:"",desc:"",content:""}),p=B(!1),r=B({}),a=async()=>{c.value=!0;const{data:m}=await ie(d.value);C.value=m.data,g.value=m.total,c.value=!1},{tableLoading:c,list:C,params:d,pageSizes:l,total:g,handleSizeChange:b,handleCurrentChange:x}=le(a),E=()=>{p.value=!0,r.value=z()},S=async m=>{p.value=!0,Object.assign(r.value,m)},n=async m=>{await se.confirm("删除模板不可恢复","警告");const{message:i}=await de(m.id);R.success(i),a(),v.getTemplate()};return(m,i)=>{const V=I,M=ae,N=T,U=L,P=q,O=te,D=ee,Y=Z,A=X,h=H("permission"),G=ne;return f(),W("div",pe,[ce,F("div",fe,[e(O,{gutter:20,justify:"space-between"},{default:t(()=>[e(M,{span:6},{default:t(()=>[k((f(),y(V,{type:"primary",size:"default",plain:"",onClick:i[0]||(i[0]=u=>E())},{default:t(()=>[_(" 添加模板 ")]),_:1})),[[h,"template:add"]])]),_:1}),e(M,{span:18},{default:t(()=>[e(P,{ref:"queryFormRef",inline:"",style:{float:"right"},size:"default",model:s(d)},{default:t(()=>[e(U,{label:"模板/描述",prop:"name"},{default:t(()=>[e(N,{modelValue:s(d).name,"onUpdate:modelValue":i[1]||(i[1]=u=>s(d).name=u),clearable:""},null,8,["modelValue"])]),_:1}),e(U,null,{default:t(()=>[e(V,{type:"primary",onClick:a},{default:t(()=>[_("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),k((f(),y(Y,{"element-loading-text":"加载中...",border:"",data:s(C)},{default:t(()=>[e(D,{label:"ID",prop:"id",align:"center",width:"60px"}),e(D,{align:"center",label:"模板名",prop:"name"}),e(D,{align:"center",label:"模板描述",prop:"desc"}),e(D,{align:"center",width:"170px",label:"操作"},{default:t(({row:u})=>[k((f(),y(V,{size:"small",type:"primary",onClick:J=>S(u)},{default:t(()=>[_("编辑 ")]),_:2},1032,["onClick"])),[[h,"template:edit"]]),k((f(),y(V,{size:"small",type:"danger",onClick:J=>n(u)},{default:t(()=>[_(" 删除 ")]),_:2},1032,["onClick"])),[[h,"template:del"]])]),_:1})]),_:1},8,["data"])),[[G,s(c)]]),F("div",_e,[e(A,{background:"","current-page":s(d).page,"page-sizes":s(l),"page-size":s(d).pageSize,layout:"total, sizes, prev, pager, next, jumper",total:s(g),onSizeChange:s(b),onCurrentChange:s(x)},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"])]),e(me,{visible:p.value,"onUpdate:visible":i[2]||(i[2]=u=>p.value=u),formData:r.value,"onUpdate:formData":i[3]||(i[3]=u=>r.value=u),onDone:a},null,8,["visible","formData"])])}}};export{xe as default};
