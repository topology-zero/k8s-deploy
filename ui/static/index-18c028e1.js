import{s as b,_ as k,u as E,a as S,b as C,r as n,o as F,w as q,c as B,d as K,e as r,f as o,g as a,E as R,h as w,i as U,j as $,k as N,l as M,m as j,n as A,p as L,q as T}from"./index-95613dab.js";function z(){return b({url:"/code"})}const D=d=>(L("data-v-6fcf76d2"),d=d(),T(),d),G={class:"login-container"},H={class:"login-img"},J=D(()=>r("div",{class:"title-container"},[r("h3",{class:"title"},"K8S 部署管理平台")],-1)),O=["src"],P={__name:"index",setup(d){const y=E(),V=S(),h=C(),v=n(),s=n({username:"",password:"",codeId:"",code:""}),g=n(),i=n(!1),f=n();F(()=>c());const p=async()=>{await v.value.validate(),i.value=!0;try{await h.login(s.value),V.push({path:f.value||"/"})}finally{c(),i.value=!1}},c=async()=>{const{data:l}=await z();s.value.codeId=l.id,g.value=l.image};return q(()=>y.query,l=>{f.value=l&&l.redirect},{immediate:!0}),(l,e)=>{const u=N,m=M,_=j,x=A,I=R;return B(),K("div",G,[r("div",H,[o(u,{"icon-class":"login",style:{height:"100%",width:"100%"}})]),o(I,{ref_key:"loginFormRef",ref:v,model:s.value,class:"login-form","label-position":"left"},{default:a(()=>[J,o(_,{prop:"username",rules:{required:!0,trigger:"blur",message:"请输入用户名"}},{default:a(()=>[o(m,{modelValue:s.value.username,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.username=t),placeholder:"用户名"},{prepend:a(()=>[o(u,{"icon-class":"user"})]),_:1},8,["modelValue"])]),_:1}),o(_,{prop:"password",rules:{required:!0,trigger:"blur",min:6,message:"长度至少为6位"}},{default:a(()=>[o(m,{modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.password=t),type:"password",placeholder:"密码","show-password":"",onKeyup:e[2]||(e[2]=w(t=>p(),["enter"]))},{prepend:a(()=>[o(u,{"icon-class":"password"})]),_:1},8,["modelValue"])]),_:1}),o(_,{prop:"code",rules:{required:!0,trigger:"blur",len:4,message:"请输入正确的验证码长度"}},{default:a(()=>[o(m,{modelValue:s.value.code,"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.code=t),placeholder:"验证码",onKeyup:e[4]||(e[4]=w(t=>p(),["enter"]))},{prepend:a(()=>[o(u,{"icon-class":"verify"})]),_:1},8,["modelValue"]),r("span",{class:"show-virify",onClick:e[5]||(e[5]=t=>c())},[r("img",{src:g.value},null,8,O)])]),_:1}),o(x,{loading:i.value,type:"primary",style:{width:"100%","margin-bottom":"30px"},onClick:e[6]||(e[6]=U(t=>p(),["prevent"]))},{default:a(()=>[$("登录")]),_:1},8,["loading"])]),_:1},8,["model"])])}}},W=k(P,[["__scopeId","data-v-6fcf76d2"]]);export{W as default};
