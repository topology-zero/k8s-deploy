import{an as q,ao as A,t as P,Z as G,c as n,d as y,aa as C,G as g,$ as w,j as V,I as E,T as $,e as j,ab as K,Y as Q,ak as Y,a as Z,L,r as k,w as H,M as v,g as t,f as o,N as S,O as h,P as B,l as J,m as W,E as X,n as T,Q as ee,_ as ae,K as le,ba as te}from"./index-95613dab.js";import{E as oe,a as se}from"./el-col-70d140ea.js";import{a as ne,E as de}from"./el-table-column-4a0e4f66.js";import"./el-checkbox-b30da6b0.js";import{E as re,a as ue}from"./el-select-4c2944db.js";import{b as me,c as ie}from"./api-4d4a2e68.js";import{v as F,L as I}from"./directive-ec7dcf29.js";import"./index-d37ca481.js";const pe=q({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:A([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),ce=P({name:"ElCard"}),_e=P({...ce,props:pe,setup(p){const m=G("card");return(s,a)=>(n(),y("div",{class:C([g(m).b(),g(m).is(`${s.shadow}-shadow`)])},[s.$slots.header||s.header?(n(),y("div",{key:0,class:C(g(m).e("header"))},[w(s.$slots,"header",{},()=>[V(E(s.header),1)])],2)):$("v-if",!0),j("div",{class:C([g(m).e("body"),s.bodyClass]),style:K(s.bodyStyle)},[w(s.$slots,"default")],6),s.$slots.footer||s.footer?(n(),y("div",{key:1,class:C(g(m).e("footer"))},[w(s.$slots,"footer",{},()=>[V(E(s.footer),1)])],2)):$("v-if",!0)],2))}});var fe=Q(_e,[["__file","card.vue"]]);const ve=Y(fe),ye={install(p){p.directive("loading",F),p.config.globalProperties.$loading=I},directive:F,service:I};const be={__name:"add-edit-dialog",props:{visible:{type:Boolean},visibleModifiers:{},formData:{type:Object},formDataModifiers:{}},emits:["update:visible","update:formData"],setup(p){const m=Z(),s=L(p,"visible"),a=L(p,"formData"),c=k();H(()=>a.value.id,async i=>{const l=ye.service({lock:!0,text:"Loading",target:document.body,background:"rgba(0, 0, 0, 0.7)",customClass:"new-index"});try{const{data:d}=await me(i);c.value=d}finally{l.close()}});const D=i=>{const l=c.value.filter(d=>i==d.templateContent)[0];a.value.params=l.params,a.value.templateName=l.templateName,a.value.templateContent=l.templateContent},_=k(),b=async()=>{await _.value.validate();for(const i in a.value.params)if(a.value.params[i].name==""||a.value.params[i].value=="")return B.error("参数名和参数值必填");await ie(a.value),s.value=!1,B.success("成功"),m.push("/deploy/index")};return(i,l)=>{const d=J,f=W,u=ue,U=re,N=ne,M=de,R=X,z=T,x=ee;return n(),v(x,{title:"上线项目",modelValue:s.value,"onUpdate:modelValue":l[6]||(l[6]=e=>s.value=e),"close-on-click-modal":!1,width:"50%"},{footer:t(()=>[o(z,{onClick:l[4]||(l[4]=e=>s.value=!1)},{default:t(()=>[V("取 消")]),_:1}),o(z,{type:"primary",onClick:l[5]||(l[5]=e=>b())},{default:t(()=>[V("确 定")]),_:1})]),default:t(()=>[o(R,{ref_key:"elFormRef",ref:_,model:a.value,"label-width":"160px"},{default:t(()=>[o(f,{label:"上线名",rules:{required:!0,trigger:"blur",message:"请输入上线名"},prop:"name"},{default:t(()=>[o(d,{modelValue:a.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.name=e)},null,8,["modelValue"])]),_:1}),o(f,{label:"项目名"},{default:t(()=>[o(d,{modelValue:a.value.projectName,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.projectName=e),disabled:""},null,8,["modelValue"])]),_:1}),o(f,{label:"项目描述"},{default:t(()=>[o(d,{modelValue:a.value.projectDesc,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value.projectDesc=e),disabled:""},null,8,["modelValue"])]),_:1}),o(f,{label:"使用模板",rules:{required:!0,trigger:"blur",message:"请输入使用模板"},prop:"template"},{default:t(()=>[o(U,{modelValue:a.value.template,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value.template=e),onChange:D,style:{width:"100%"}},{default:t(()=>[(n(!0),y(h,null,S(c.value,(e,r)=>(n(),v(u,{key:r,label:e.templateName,value:e.templateContent},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a.value.params?(n(),v(f,{key:0,label:"模板变量"},{default:t(()=>[o(M,{border:"","empty-text":"请先选择使用的模板",style:{"margin-top":"10px"},size:"small",data:a.value.params},{default:t(()=>[o(N,{align:"center",label:"参数名",prop:"name"},{default:t(({row:e})=>[o(d,{modelValue:e.name,"onUpdate:modelValue":r=>e.name=r,disabled:"",size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(N,{align:"center",label:"参数值",prop:"desc"},{default:t(({row:e})=>[e.options?(n(),v(U,{key:0,size:"small",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,style:{width:"100%"}},{header:t(()=>[o(d,{placeholder:"自定义",size:"small",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r},null,8,["modelValue","onUpdate:modelValue"])]),default:t(()=>[(n(!0),y(h,null,S(e.options,(r,O)=>(n(),v(u,{key:O,label:r,value:r},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(n(),v(d,{key:1,modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1})]),_:1},8,["data"])]),_:1})):$("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};const ge={class:"project-container"},Ve={class:"my-card-header"},Ce={class:"my-card-body"},Ee={__name:"new-deploy",setup(p){const m=le(),{project:s}=te(m),a=k(!1),c=k({}),D=async _=>{c.value={id:_.id,projectName:_.name,projectDesc:_.desc},a.value=!0};return(_,b)=>{const i=T,l=ve,d=se,f=oe;return n(),y("div",ge,[o(f,{gutter:20},{default:t(()=>[(n(!0),y(h,null,S(g(s),u=>(n(),v(d,{span:4,class:"my-col",key:u.id},{default:t(()=>[o(l,null,{header:t(()=>[j("div",Ve,E(u.name),1)]),footer:t(()=>[o(i,{type:"primary",onClick:U=>D(u),size:"small"},{default:t(()=>[V("部署")]),_:2},1032,["onClick"])]),default:t(()=>[j("div",Ce,E(u.desc),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),o(be,{visible:a.value,"onUpdate:visible":b[0]||(b[0]=u=>a.value=u),formData:c.value,"onUpdate:formData":b[1]||(b[1]=u=>c.value=u)},null,8,["visible","formData"])])}}},Ne=ae(Ee,[["__scopeId","data-v-c5e92a8f"]]);export{Ne as default};
